[
    {
      "schemaname": "public",
      "tablename": "News",
      "policyname": "Admins can manage all news",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "(EXISTS ( SELECT 1\n   FROM \"User\"\n  WHERE (((\"User\".id)::text = (auth.uid())::text) AND (\"User\".role = 'admin'::text))))",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "News",
      "policyname": "Anyone can read published news",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "(published = true)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "Post",
      "policyname": "Authors can manage their own posts",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "((auth.uid())::text = (\"authorId\")::text)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "Post",
      "policyname": "Users can read published posts",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "(published = true)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "User",
      "policyname": "Service role can manage all users",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "(auth.role() = 'service_role'::text)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "User",
      "policyname": "Users can read their own data",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "((auth.uid())::text = (id)::text)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_enrollments",
      "policyname": "Users can enroll themselves",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "INSERT",
      "qual": null,
      "with_check": "(auth.uid() = user_id)"
    },
    {
      "schemaname": "public",
      "tablename": "course_enrollments",
      "policyname": "Users can update their enrollments",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "UPDATE",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_enrollments",
      "policyname": "Users can view their enrollments",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_lessons",
      "policyname": "Only admins can manage course lessons",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_lessons",
      "policyname": "Public course lessons are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_objectives",
      "policyname": "Only admins can manage course objectives",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_objectives",
      "policyname": "Public course objectives are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_requirements",
      "policyname": "Only admins can manage course requirements",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_requirements",
      "policyname": "Public course requirements are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_reviews",
      "policyname": "All reviews are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_reviews",
      "policyname": "Users can create their own reviews",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "INSERT",
      "qual": null,
      "with_check": "(auth.uid() = user_id)"
    },
    {
      "schemaname": "public",
      "tablename": "course_reviews",
      "policyname": "Users can delete their own reviews",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "DELETE",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_reviews",
      "policyname": "Users can update their own reviews",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "UPDATE",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_sections",
      "policyname": "Only admins can manage course sections",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "ALL",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "course_sections",
      "policyname": "Public course sections are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "courses",
      "policyname": "Only admins can delete courses",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "DELETE",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "courses",
      "policyname": "Only admins can insert courses",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "INSERT",
      "qual": null,
      "with_check": "is_admin()"
    },
    {
      "schemaname": "public",
      "tablename": "courses",
      "policyname": "Only admins can update courses",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "UPDATE",
      "qual": "is_admin()",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "courses",
      "policyname": "Public courses are viewable by everyone",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "true",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "user_lesson_progress",
      "policyname": "Users can create their own progress",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "INSERT",
      "qual": null,
      "with_check": "(auth.uid() = user_id)"
    },
    {
      "schemaname": "public",
      "tablename": "user_lesson_progress",
      "policyname": "Users can update their own progress",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "UPDATE",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "user_lesson_progress",
      "policyname": "Users can view their own progress",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "(auth.uid() = user_id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "user_profiles",
      "policyname": "Allow profile creation",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "INSERT",
      "qual": null,
      "with_check": "(auth.uid() = id)"
    },
    {
      "schemaname": "public",
      "tablename": "user_profiles",
      "policyname": "Users can read own profile",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "SELECT",
      "qual": "(auth.uid() = id)",
      "with_check": null
    },
    {
      "schemaname": "public",
      "tablename": "user_profiles",
      "policyname": "Users can update own profile except role",
      "permissive": "PERMISSIVE",
      "roles": "{public}",
      "cmd": "UPDATE",
      "qual": "(auth.uid() = id)",
      "with_check": "((auth.uid() = id) AND ((role)::text = (( SELECT user_profiles_1.role\n   FROM user_profiles user_profiles_1\n  WHERE (user_profiles_1.id = auth.uid())))::text))"
    }
  ]