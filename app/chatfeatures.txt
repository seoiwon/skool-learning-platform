채팅 기능 설명서

1. 메인 페이지의 한 section 안에 구현함.
2. 상담하기 버튼 클릭
3. [공개, 비공개, 친구초대] 세 가지 중 체크박스로 선택함
4. [친구초대] 선택시, 친구의 이메일 주소 기입해야 함. (+ - 버튼으로 초대할 친구 추가 또는 삭제 할 수 있음)
5. 상담하기 버튼을 다시 누르면, 채팅방으로 입장됨. 
6. 친구초대 선택 후 상담하기 버튼을 누르면 해당 이메일로 초대링크 발송
7. 친구는 이메일에서 초대링크를 누르면, 회원가입 페이지로 이동하고- 채팅방으로 바로입장함.
8. 모든 채팅방 생성 이후 - 메인페이지의 섹션에서 해당 채팅방이 보여짐. 다수의 채팅방이 보여질 수 있고, 가로스크롤을 통해서 전체 생성된 채팅방 확인할 수 있음.
9. 공개는 누구나 입장 가능함
10. 비공개는 생성한 사람만 생성하자 마자 바로 입장
11. 친구초대는 생성한 사람과 초대한 친구들만 링크를 통해 입장. 브라우저를 종료하고 다시 접속 경우, 자기가 초대된 채팅방이 다른 채팅 목록보다 가장 앞에 보여지고 초록색으로 보여짐.(나의채팅방 뱃지)
12. 비공개는 브라우저 종료하고 다시 접속한 경우 자신의 채팅방이 다른 채팅 목록보다 가장 앞에 보여지고 초록색으로 보여짐.(나의채팅방 뱃지)

13. Next.js로 개발되어 있는데, 안드로이드 폰에서라도 푸쉬메세지를 사용할 수 있는지 궁금함. 


  1. Supabase 데이터베이스 스키마 설정

  - users 테이블: id, email, created_at
  - chat_rooms 테이블: id, creator_id, type (public/private/invite), created_at
  - chat_members 테이블: room_id, user_id, joined_at, is_creator
  - chat_invitations 테이블: room_id, email, token, created_at, accepted
  - messages 테이블: id, room_id, user_id, content, created_at

  2. 사용자 인증 및 프로필 관리

  - Supabase Auth로 회원가입/로그인 구현
  - 이메일 인증 설정
  - 사용자 세션 관리

  3. 채팅방 생성 UI (프라이버시 옵션)

  - 라디오 버튼으로 공개/비공개/친구초대 선택
  - 친구초대 시 동적 이메일 입력 필드 (+/- 버튼)
  - 채팅방 생성 API 엔드포인트

  4. 이메일 초대 시스템

  - Supabase Edge Functions로 초대 이메일 발송
  - 고유 초대 토큰 생성
  - 초대 링크 검증 및 자동 입장

  5. 실시간 채팅 기능

  - Supabase Realtime으로 메시지 구독
  - 채팅방 입장/퇴장 처리
  - 메시지 전송 및 수신

  6. 채팅방 목록 (가로 스크롤)

  - 공개 채팅방 목록 조회
  - CSS Grid 또는 Flexbox로 가로 스크롤
  - 채팅방 카드 컴포넌트

  7. 채팅방 정렬 및 하이라이트

  - localStorage로 사용자의 채팅방 추적
  - 내 채팅방 우선 정렬
  - 초록색 배지 및 스타일링

  8. 푸시 알림 (Android)

  - 가능함! PWA + Web Push API 사용
  - Service Worker 등록
  - FCM (Firebase Cloud Messaging) 연동
  - Notification API로 알림 표시

  푸시 알림 구현 방법:

  1. Next.js PWA 플러그인 설치 (next-pwa)
  2. Service Worker 설정
  3. Web Push 구독 요청
  4. Supabase Edge Functions로 푸시 발송
  5. Android Chrome에서 네이티브 알림처럼 작동